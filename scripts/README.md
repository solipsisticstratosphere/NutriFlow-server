# Database Management Scripts

Скрипти для управління базою даних NutriFlow.

## Доступні команди

### 1. Очистити базу даних
```bash
npm run db:clear
```
Видаляє всі дані з усіх колекцій (Users, Products, Meals, DailyLogs), але залишає структуру колекцій та індекси.

### 2. Заповнити базу тестовими даними
```bash
npm run db:seed
```

Створює:
- **3 тестових користувачі:**
  - olena@example.com (Password: Test123) - жінка, 28 років, ціль: схуднути
  - andriy@example.com (Password: Test123) - чоловік, 32 роки, ціль: набрати м'язову масу
  - maria@example.com (Password: Test123) - жінка, 25 років, ціль: підтримувати вагу

- **34 публічних продукти:**
  - Овочі (6): помідор, огірок, морква, капуста, цибуля, перець
  - Фрукти (4): банан, яблуко, апельсин, груша
  - М'ясо (4): курка, яловичина, свинина, індичка
  - Риба (3): лосось, тунець, треска
  - Молочні (5): молоко, кефір, творог, йогурт, сир
  - Крупи (5): гречка, рис, вівсянка, хліб, макарони
  - Бобові (3): квасоля, сочевиця, нут
  - Горіхи (2): грецький горіх, мигдаль
  - Інше (2): яйце, олія

- **3 прийоми їжі для Олени:**
  - Сніданок (361 ккал): вівсянка, банан, молоко
  - Обід (527 ккал): куряча грудка, гречка, огірок, помідор
  - Вечеря (466 ккал): лосось, рис, перець

- **DailyLog** з загальною статистикою дня

### 3. Повний reset (очистити + заповнити)
```bash
npm run db:reset
```
Спочатку очищує базу, потім заповнює новими тестовими даними.

## Тестовий workflow

Для повного тестування всього функціоналу (AI, meals, recommendations):

```bash
# 1. Переконайтесь що сервер запущений
npm start

# 2. В іншому терміналі запустіть повний workflow тест
node scripts/full-workflow-test.js
```

### Що тестує full-workflow-test.js:
1. ✅ Очищує БД
2. ✅ Заповнює тестовими даними
3. ✅ Логін користувача
4. ✅ Створює продукти через AI (авокадо)
5. ✅ Отримує список всіх продуктів
6. ✅ Створює прийом їжі з кількох продуктів
7. ✅ Отримує AI рекомендації

## Структура файлів

```
scripts/
├── README.md                   # Ця документація
├── clear-db.js                 # Скрипт очищення БД
├── seed.js                     # Seeder з тестовими даними
└── full-workflow-test.js       # Повний тест робочого процесу
```

## Приклад використання

```bash
# Розробка: reset БД перед тестуванням
npm run db:reset

# Production: тільки очистити без заповнення
npm run db:clear

# Додати тестові дані до існуючої БД
npm run db:seed
```

## Примітки

- Всі тестові користувачі мають пароль: **Test123**
- Продукти створюються як публічні (isPublic: true)
- Денні норми КБЖУ розраховуються автоматично на основі профілю користувача
- DailyLog автоматично оновлюється при створенні/редагуванні прийомів їжі
